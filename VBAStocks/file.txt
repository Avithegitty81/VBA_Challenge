Sub VbaStock(): ' Defining the Variables      Dim Ticker As String      Dim YearlyChange As Double      YearlyChange = 0      Dim PercentageChange As Double      PercentageChange = 0      Dim TotalVolume As Double      TotalVolume = 0      Dim OpenValue As Double      OpenValue = 2      Dim CloseValue As Double      Dim Summary_Table_Row As Double      Summary_Table_Row = 2      Dim Days As Long      Days = 0      For Each ws In Worksheets      ws.Activate ' Defining the Range      Range("I1") = "Ticker"      Range("J1") = "YearlyChange"      Range("K1") = "PercentageChange"      Range("L1") = "TotalVolume"    Lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row    sumrow = ws.Cells(Rows.Count, 9).End(xlUp).Row    OpenValue = 2        For i = 2 To Lastrow               If ws.Cells(i, 1).Value = ws.Cells(i + 1, 1).Value Then                    Ticker = ws.Cells(i, 1).Value                    Days = Days + 1               Else                    OpenValue = ws.Cells(i - Days, 3).Value                    CloseValue = ws.Cells(i, 6).Value                    YearlyChange = CloseValue - OpenValue                            If OpenValue = 0 Then                                    PercentageChange = 0                            Else                                    PercentageChange = (CloseValue - OpenValue) / OpenValue                            End If                    TotalVolume = TotalVolume + ws.Cells(i, 7).Value                    ws.Range("I" & Summary_Table_Row).Value = Ticker                    ws.Range("J" & Summary_Table_Row).Value = YearlyChange                    ws.Range("K" & Summary_Table_Row).Value = Format(PercentageChange, "0%")                    ws.Range("L" & Summary_Table_Row).Value = TotalVolume                    Summary_Table_Row = Summary_Table_Row + 1                    TotalVolume = 0                    Days = 0                End If           Next i           Max_Percentage = 0           Ticker_Name = " "           For j = 2 To somrow              If ws.Cells(j, 10).Value > 0 Then                   ws.Cells(j, 10).Interior.ColorIndex = 4                Else                     ws.Cells(j, 10).Interior.ColorIndex = 3                End If                If ws.Cells(j, 11).Value > Max_Percentage Then                      Max_Percentage = ws.Cells(j, 11).Value                      Ticker_Name = ws.Cells(j, 9).Value                  End If                Next j                ws.Cells(2, 15).Value = Max_Percentage                ws.Cells(2, 14).Value = Ticker_Name                ws.Cells(1, 9).Value = "Ticker"                ws.Cells(1, 10).Value = "YearlyChange"                ws.Cells(1, 11).Value = " PercentageChange"                ws.Cells(1, 12).Value = "TotalVolume"                    ' Declaring the Variables                        Dim Greatest_Inc As Double                Greatest_Inc = 0                Dim Greatest_Decrease As Double                Greatest_Decrease = 0                Dim Greatest_Volume As Double                Greatest_Volume = 0                          'Definig the Summary_Table_Row                          ws.Cells(1, 14) = " "                ws.Cells(2, 14) = "Greatest_Increase"                ws.Cells(3, 14) = "Greatest_Decrease"                ws.Cells(4, 14) = "Greatest_Volume"                ws.Cells(1, 15) = "Ticker"                ws.Cells(1, 16) = "Value"                                Lastrow = ws.Cells(Rows.Count, 9).End(xlUp).Row                                For k = 2 To Lastrow                    If Cells(k, 11).Value > Greatest_Increase Then                       Greatest_Increase = Cells(k, 11).Value                    End If                Next k   Next wsEnd Sub